!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Carousel=t():e.Carousel=t()}(self,(()=>(()=>{var e={868:e=>{e.exports='<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.15 13.628A7.749 7.749 0 0 0 10 17.75a7.74 7.74 0 0 0 6.305-3.242l-2.387-2.127-2.765 2.244-4.389-4.496-3.614 3.5zm-.787-2.303l4.446-4.371 4.52 4.63 2.534-2.057 3.533 2.797c.23-.734.354-1.514.354-2.324a7.75 7.75 0 1 0-15.387 1.325zM10 20C4.477 20 0 15.523 0 10S4.477 0 10 0s10 4.477 10 10-4.477 10-10 10z"></path></svg>'},964:()=>{"use strict";var e,t,o,r,i,n,s,a,l,d,c;o=Object.create,r=Object.defineProperty,i=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,s=Object.getPrototypeOf,a=Object.prototype.hasOwnProperty,e=(e,t)=>{var o=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,escape).replace(/%20/g,"+")},r=function(e,t,i,n){return t=t||null,i=i||"&",n=n||null,e?function(e){for(var t=new Array,o=0;o<e.length;o++)e[o]&&t.push(e[o]);return t}(Object.keys(e).map((function(s){var a,l=s;if(n&&(l=n+"["+l+"]"),"object"==typeof e[s]&&null!==e[s])a=r(e[s],null,i,l);else{t&&(l=function(e){return!isNaN(parseFloat(e))&&isFinite(e)}(l)?t+Number(l):l);var d=e[s];d=(d=0===(d=!1===(d=!0===d?"1":d)?"0":d)?"0":d)||"",a=o(l)+"="+o(d)}return a}))).join(i).replace(/[!'()*]/g,""):""};t.exports=r},l=((e,t,l)=>(l=null!=e?o(s(e)):{},((e,t,o,s)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let o of n(t))!a.call(e,o)&&undefined!==o&&r(e,o,{get:()=>t[o],enumerable:!(s=i(t,o))||s.enumerable});return e})(r(l,"default",{value:e,enumerable:!0}),e)))((t||e(t={exports:{}},t),t.exports)),d=class{static urlEncode(e){return(0,l.default)(e)}static jsonEncode(e){return JSON.stringify(e)}static formEncode(e){if(this.isFormData(e))return e;if(this.isFormElement(e))return new FormData(e);if(this.isObject(e)){let t=new FormData;return Object.keys(e).forEach((o=>{let r=e[o];t.append(o,r)})),t}throw new Error("`data` must be an instance of Object, FormData or <FORM> HTMLElement")}static isObject(e){return"[object Object]"===Object.prototype.toString.call(e)}static isFormData(e){return e instanceof FormData}static isFormElement(e){return e instanceof HTMLFormElement}static selectFiles(e={}){return new Promise(((t,o)=>{let r=document.createElement("INPUT");r.type="file",e.multiple&&r.setAttribute("multiple","multiple"),e.accept&&r.setAttribute("accept",e.accept),r.style.display="none",document.body.appendChild(r),r.addEventListener("change",(e=>{let o=e.target.files;t(o),document.body.removeChild(r)}),!1),r.click()}))}static parseHeaders(e){let t=e.trim().split(/[\r\n]+/),o={};return t.forEach((function(e){let t=e.split(": "),r=t.shift(),i=t.join(": ");r&&(o[r]=i)})),o}},c=(()=>{let e={URLENCODED:"application/x-www-form-urlencoded; charset=utf-8",FORM:"multipart/form-data",JSON:"application/json; charset=utf-8"},t=function(e){return new Promise(((t,o)=>{e=r(e),(e=i(e)).beforeSend&&e.beforeSend();let n=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");n.open(e.method,e.url),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),Object.keys(e.headers).forEach((t=>{let o=e.headers[t];n.setRequestHeader(t,o)}));let a=e.ratio;n.upload.addEventListener("progress",(t=>{let o=Math.round(t.loaded/t.total*100),r=Math.ceil(o*a/100);e.progress(Math.min(r,100))}),!1),n.addEventListener("progress",(t=>{let o=Math.round(t.loaded/t.total*100),r=Math.ceil(o*(100-a)/100)+a;e.progress(Math.min(r,100))}),!1),n.onreadystatechange=()=>{if(4===n.readyState){let e=n.response;try{e=JSON.parse(e)}catch(e){}let r=d.parseHeaders(n.getAllResponseHeaders()),i={body:e,code:n.status,headers:r};s(n.status)?t(i):o(i)}},n.send(e.data)}))},o=function(e){return e.method="POST",t(e)},r=function(t={}){if(t.url&&"string"!=typeof t.url)throw new Error("Url must be a string");if(t.url=t.url||"",t.method&&"string"!=typeof t.method)throw new Error("`method` must be a string or null");if(t.method=t.method?t.method.toUpperCase():"GET",t.headers&&"object"!=typeof t.headers)throw new Error("`headers` must be an object or null");if(t.headers=t.headers||{},t.type&&("string"!=typeof t.type||!Object.values(e).includes(t.type)))throw new Error("`type` must be taken from module's «contentType» library");if(t.progress&&"function"!=typeof t.progress)throw new Error("`progress` must be a function or null");if(t.progress=t.progress||(e=>{}),t.beforeSend=t.beforeSend||(e=>{}),t.ratio&&"number"!=typeof t.ratio)throw new Error("`ratio` must be a number");if(t.ratio<0||t.ratio>100)throw new Error("`ratio` must be in a 0-100 interval");if(t.ratio=t.ratio||90,t.accept&&"string"!=typeof t.accept)throw new Error("`accept` must be a string with a list of allowed mime-types");if(t.accept=t.accept||"*/*",t.multiple&&"boolean"!=typeof t.multiple)throw new Error("`multiple` must be a true or false");if(t.multiple=t.multiple||!1,t.fieldName&&"string"!=typeof t.fieldName)throw new Error("`fieldName` must be a string");return t.fieldName=t.fieldName||"files",t},i=function(t){switch(t.method){case"GET":let o=n(t.data,e.URLENCODED);delete t.data,t.url=/\?/.test(t.url)?t.url+"&"+o:t.url+"?"+o;break;case"POST":case"PUT":case"DELETE":case"UPDATE":let r=function(t={}){return t.type||e.JSON}(t);(d.isFormData(t.data)||d.isFormElement(t.data))&&(r=e.FORM),t.data=n(t.data,r),r!==c.contentType.FORM&&(t.headers["content-type"]=r)}return t},n=function(t={},o){switch(o){case e.URLENCODED:return d.urlEncode(t);case e.JSON:return d.jsonEncode(t);case e.FORM:return d.formEncode(t);default:return t}},s=function(e){return e>=200&&e<300};return{contentType:e,request:t,get:function(e){return e.method="GET",t(e)},post:o,transport:function(e){return e=r(e),d.selectFiles(e).then((t=>{let r=new FormData;for(let o=0;o<t.length;o++)r.append(e.fieldName,t[o],t[o].name);d.isObject(e.data)&&Object.keys(e.data).forEach((t=>{let o=e.data[t];r.append(t,o)}));let i=e.beforeSend;return e.beforeSend=function(){return i(t)},e.data=r,o(e)}))},selectFiles:function(e){return delete(e=r(e)).beforeSend,d.selectFiles(e)}}})()}},t={};function o(r){var i=t[r];if(void 0!==i)return i.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,o),n.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r={};return(()=>{"use strict";o.d(r,{default:()=>l});var e=o(964),t=o.n(e);class i{constructor({config:e,onUpload:t,onError:o}){this.config=e,this.onUpload=t,this.onError=o}uploadSelectedFile({onPreview:e}){const o=function(t){const o=new window.FileReader;o.readAsDataURL(t),o.onload=t=>{e(t.target.result)}};let r;r=this.config.uploader&&"function"==typeof this.config.uploader.uploadByFile?t().selectFiles({accept:this.config.types}).then((e=>{o(e[0]);const t=this.config.uploader.uploadByFile(e[0]);return n(t)||console.warn("Custom uploader method uploadByFile should return a Promise"),t})):t().transport({url:this.config.endpoints.byFile,data:this.config.additionalRequestData,accept:this.config.types,headers:this.config.additionalRequestHeaders,beforeSend:e=>{o(e[0])},fieldName:this.config.field}).then((e=>e.body)),r.then((e=>{this.onUpload(e)})).catch((e=>{this.onError(e)}))}uploadByUrl(e){let o;this.config.uploader&&"function"==typeof this.config.uploader.uploadByUrl?(o=this.config.uploader.uploadByUrl(e),n(o)||console.warn("Custom uploader method uploadByUrl should return a Promise")):o=t().post({url:this.config.endpoints.byUrl,data:Object.assign({url:e},this.config.additionalRequestData),type:t().contentType.JSON,headers:this.config.additionalRequestHeaders}).then((e=>e.body)),o.then((e=>{this.onUpload(e)})).catch((e=>{this.onError(e)}))}uploadByFile(e,{onPreview:o}){const r=new window.FileReader;let i;if(r.readAsDataURL(e),r.onload=e=>{o(e.target.result)},this.config.uploader&&"function"==typeof this.config.uploader.uploadByFile)i=this.config.uploader.uploadByFile(e),n(i)||console.warn("Custom uploader method uploadByFile should return a Promise");else{const o=new window.FormData;o.append(this.config.field,e),this.config.additionalRequestData&&Object.keys(this.config.additionalRequestData).length&&Object.entries(this.config.additionalRequestData).forEach((([e,t])=>{o.append(e,t)})),i=t().post({url:this.config.endpoints.byFile,data:o,type:t().contentType.JSON,headers:this.config.additionalRequestHeaders}).then((e=>e.body))}i.then((e=>{this.onUpload(e)})).catch((e=>{this.onError(e)}))}}function n(e){return window.Promise.resolve(e)===e}var s=o(868),a=o.n(s);class l{constructor({data:e,config:t,api:o}){this.api=o,this.data=e,this.IconClose='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" viewBox="8 8 8 8"><path stroke="currentColor" stroke-linecap="round" stroke-width="1.15" d="M8 8L12 12M12 12L16 16M12 12L16 8M12 12L8 16"></path></svg>',this.IconLeft='<svg class="icon " viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M351,9a15,15 0 01 19,0l29,29a15,15 0 01 0,19l-199,199l199,199a15,15 0 01 0,19l-29,29a15,15 0 01-19,0l-236-235a16,16 0 01 0-24z" /></svg>',this.IconRight='<svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M312,256l-199-199a15,15 0 01 0-19l29-29a15,15 0 01 19,0l236,235a16,16 0 01 0,24l-236,235a15,15 0 01-19,0l-29-29a15,15 0 01 0-19z" /></svg>',this.config={endpoints:t.endpoints||"",additionalRequestData:t.additionalRequestData||{},additionalRequestHeaders:t.additionalRequestHeaders||{},field:t.field||"image",types:t.types||"image/*",captionPlaceholder:this.api.i18n.t("Caption"),buttonContent:t.buttonContent||"",uploader:t.uploader||void 0},this.uploader=new i({config:this.config,onUpload:e=>this.onUpload(e),onError:e=>this.uploadingFailed(e)})}get CSS(){return{baseClass:this.api.styles.block,loading:this.api.styles.loader,input:this.api.styles.input,button:this.api.styles.button,wrapper:"cdxcarousel-wrapper",addButton:"cdxcarousel-addImage",block:"cdxcarousel-block",item:"cdxcarousel-item",removeBtn:"cdxcarousel-removeBtn",leftBtn:"cdxcarousel-leftBtn",rightBtn:"cdxcarousel-rightBtn",inputUrl:"cdxcarousel-inputUrl",caption:"cdxcarousel-caption",list:"cdxcarousel-list",imagePreloader:"image-tool__image-preloader"}}static get toolbox(){return{title:"Carousel",icon:'<svg width="38" height="18" viewBox="0 0 38 18" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="none"><g><path fill-rule="evenodd" clip-rule="evenodd" d="M28 16V2C28 0.9 27.1 0 26 0H12C10.9 0 10 0.9 10 2V16C10 17.1 10.9 18 12 18H26C27.1 18 28 17.1 28 16V16ZM15.5 10.5L18 13.51L21.5 9L26 15H12L15.5 10.5V10.5Z" stroke-width="2"></path><path transform="translate(-0.5,0)" fill-rule="evenodd" clip-rule="evenodd" d="M7 13.59L2.67341 9L7 4.41L5.66802 3L0 9L5.66802 15L7 13.59Z" fill="white" stroke="black" stroke-opacity="1"></path><path transform="translate(1,0)" fill-rule="evenodd" clip-rule="evenodd" d="M31 13.59L35.3266 9L31 4.41L32.332 3L38 9L32.332 15L31 13.59Z" fill="white" stroke="black" class=""></path></g></svg>'}}render(){if(this.wrapper=d("div",[this.CSS.wrapper]),this.list=d("div",[this.CSS.list]),this.addButton=this.createAddButton(),this.list.appendChild(this.addButton),this.wrapper.appendChild(this.list),this.data.length>0){console.log("load_item render",this.data);for(const e of this.data){const t=this.creteNewItem(e.url,e.caption);this.list.insertBefore(t,this.addButton)}}return this.wrapper}save(e){const t=e.getElementsByClassName(this.CSS.item),o=[];if(t.length>0)for(const e of t)e.firstChild.value&&o.push({url:e.firstChild.value,caption:e.lastChild.value});return o}creteNewItem(e,t){const o=d("div",[this.CSS.block]),r=d("div",[this.CSS.item]),i=d("div",[this.CSS.removeBtn]),n=d("div",[this.CSS.leftBtn]),s=d("div",[this.CSS.rightBtn]),a=d("input",[this.CSS.inputUrl]),l=d("div",[this.CSS.imagePreloader]);return a.value=e,n.innerHTML=this.IconLeft,n.style="padding: 8px;",n.addEventListener("click",(()=>{var e=Array.from(o.parentNode.children).indexOf(o);0!=e&&o.parentNode.insertBefore(o,o.parentNode.children[e-1])})),s.innerHTML=this.IconRight,s.style="padding: 8px;",s.addEventListener("click",(()=>{var e=Array.from(o.parentNode.children).indexOf(o);e!=o.parentNode.children.length-2&&o.parentNode.insertBefore(o,o.parentNode.children[e+2])})),i.innerHTML=this.IconClose,i.addEventListener("click",(()=>{o.remove()})),i.style.display="none",r.appendChild(a),r.appendChild(i),r.appendChild(n),r.appendChild(s),o.appendChild(r),e?this._createImage(e,r,t,i):r.appendChild(l),o}_createImage(e,t,o,r){const i=document.createElement("img"),n=d("input",[this.CSS.caption,this.CSS.input]);i.src=e,o&&(n.value=o),n.placeholder=this.config.captionPlaceholder,r.style.display="flex",t.appendChild(i),t.appendChild(n)}onUpload(e){e.success&&e.file?(console.log(this.list),console.log(this.list.childNodes.length),console.log(this.list.childNodes.length-1),this._createImage(e.file.url,this.list.childNodes[this.list.childNodes.length-2].firstChild,"",this.list.childNodes[this.list.childNodes.length-2].firstChild.childNodes[1]),this.list.childNodes[this.list.childNodes.length-2].firstChild.childNodes[2].style.backgroundImage="",this.list.childNodes[this.list.childNodes.length-2].firstChild.firstChild.value=e.file.url,this.list.childNodes[this.list.childNodes.length-2].firstChild.classList.add("cdxcarousel-item--empty")):this.uploadingFailed("incorrect response: "+JSON.stringify(e))}uploadingFailed(e){console.log("Gallery : uploading failed because of",e),this.api.notifier.show({message:this.api.i18n.t("Can not upload an image, try another"),style:"error"})}showPreloader(e){this.nodes.imagePreloader.style.backgroundImage=`url(${e})`}onSelectFile(){this.uploader.uploadSelectedFile({onPreview:e=>{const t=this.creteNewItem("","");t.firstChild.lastChild.style.backgroundImage=`url(${e})`,console.log("preload",t.firstChild.lastChild),this.list.insertBefore(t,this.addButton),console.log(e)}})}createAddButton(){const e=d("div",[this.CSS.button,this.CSS.addButton]),t=d("div",[this.CSS.block]);return e.innerHTML=`${a()} Add Image`,e.addEventListener("click",(()=>{this.onSelectFile()})),t.appendChild(e),t}}const d=function(e,t=null,o={}){const r=document.createElement(e);Array.isArray(t)?r.classList.add(...t):t&&r.classList.add(t);for(const e in o)r[e]=o[e];return r}})(),r.default})()));